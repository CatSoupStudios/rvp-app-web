---
// src/components/Contact.astro
---

<section id="contact" class="relative py-24 md:py-32 bg-[var(--brand-primary)] text-[#EAE0D5] overflow-hidden">

  <div class="absolute top-[-20%] right-[-10%] w-[600px] h-[600px] bg-[var(--brand-accent)]/5 rounded-full blur-[120px] pointer-events-none"></div>

  <div class="max-w-7xl mx-auto px-6 relative z-10">
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24 items-start">
      
      <div>
        <span class="text-[var(--brand-accent)] font-bold tracking-[0.2em] uppercase text-xs block mb-6">
          Get in Touch
        </span>
        <h2 class="text-5xl md:text-7xl font-serif font-medium leading-[1.1] mb-8 text-white">
          Ready to elevate <br/>
          <span class="italic text-[var(--brand-accent)] opacity-90">your space?</span>
        </h2>
        <p class="text-white/60 text-lg font-light leading-relaxed mb-12 max-w-md">
          Tell us about your vision. Whether it's a single room refresh or a full estate transformation, we bring the same level of precision to every project.
        </p>

        <div class="space-y-8">
          <div class="flex items-start gap-5 group cursor-pointer">
            <div class="w-12 h-12 rounded-full border border-white/10 flex items-center justify-center text-[var(--brand-accent)] group-hover:border-[var(--brand-accent)] group-hover:bg-[var(--brand-accent)] group-hover:text-[var(--brand-primary)] transition-all duration-300">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/></svg>
            </div>
            <div>
              <span class="text-xs uppercase tracking-widest text-white/40 block mb-1">Call us directly</span>
              <a href="tel:6614286638" class="text-2xl font-serif text-white group-hover:text-[var(--brand-accent)] transition-colors">
                (661) 428-6638
              </a>
            </div>
          </div>

          <div class="flex items-start gap-5 group cursor-pointer">
            <div class="w-12 h-12 rounded-full border border-white/10 flex items-center justify-center text-[var(--brand-accent)] group-hover:border-[var(--brand-accent)] group-hover:bg-[var(--brand-accent)] group-hover:text-[var(--brand-primary)] transition-all duration-300">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/></svg>
            </div>
            <div>
              <span class="text-xs uppercase tracking-widest text-white/40 block mb-1">Email us</span>
              <a href="mailto:info@rangelvalleypainting.com" class="text-xl md:text-2xl font-serif text-white group-hover:text-[var(--brand-accent)] transition-colors">
                info@rangelvalleypainting.com
              </a>
            </div>
          </div>
        </div>
      </div>

      <div class="relative bg-white/5 p-8 md:p-12 rounded-[2rem] border border-white/10 backdrop-blur-sm">
        
        <form id="contact-form" class="space-y-8 transition-all duration-500 opacity-100">
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="group relative">
              <input type="text" id="name" name="name" required 
                class="peer w-full bg-transparent border-b border-white/20 py-3 text-white placeholder-transparent focus:outline-none focus:border-[var(--brand-accent)] transition-colors font-light tracking-wide"
                placeholder="Name"
              />
              <label for="name" 
                class="absolute left-0 -top-3.5 text-xs text-[var(--brand-accent)] transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-white/40 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[var(--brand-accent)] peer-focus:text-xs uppercase tracking-widest">
                Full Name
              </label>
            </div>

            <div class="group relative">
              <input type="tel" id="phone" name="phone" 
                class="peer w-full bg-transparent border-b border-white/20 py-3 text-white placeholder-transparent focus:outline-none focus:border-[var(--brand-accent)] transition-colors font-light tracking-wide"
                placeholder="Phone"
              />
              <label for="phone" 
                class="absolute left-0 -top-3.5 text-xs text-[var(--brand-accent)] transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-white/40 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[var(--brand-accent)] peer-focus:text-xs uppercase tracking-widest">
                Phone Number
              </label>
            </div>
          </div>

          <div class="group relative">
            <input type="email" id="email" name="email" required 
              class="peer w-full bg-transparent border-b border-white/20 py-3 text-white placeholder-transparent focus:outline-none focus:border-[var(--brand-accent)] transition-colors font-light tracking-wide"
              placeholder="Email"
            />
            <label for="email" 
              class="absolute left-0 -top-3.5 text-xs text-[var(--brand-accent)] transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-white/40 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[var(--brand-accent)] peer-focus:text-xs uppercase tracking-widest">
              Email Address
            </label>
          </div>

          <div class="group relative">
            <select id="service" name="service" class="peer w-full bg-transparent border-b border-white/20 py-3 text-white focus:outline-none focus:border-[var(--brand-accent)] transition-colors font-light tracking-wide appearance-none">
              <option value="" disabled selected class="bg-[var(--brand-primary)] text-white/50">Select a Service</option>
              <option value="interior" class="bg-[var(--brand-primary)]">Residential Interior</option>
              <option value="exterior" class="bg-[var(--brand-primary)]">Residential Exterior</option>
              <option value="cabinets" class="bg-[var(--brand-primary)]">Cabinet Refinishing</option>
              <option value="commercial" class="bg-[var(--brand-primary)]">Commercial Project</option>
            </select>
            <label class="absolute left-0 -top-3.5 text-xs text-[var(--brand-accent)] uppercase tracking-widest">
              Interested In
            </label>
            <div class="absolute right-0 top-4 pointer-events-none text-white/40">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 9l-7 7-7-7"/></svg>
            </div>
          </div>

          <div class="group relative">
            <textarea id="message" name="message" rows="3"
              class="peer w-full bg-transparent border-b border-white/20 py-3 text-white placeholder-transparent focus:outline-none focus:border-[var(--brand-accent)] transition-colors font-light tracking-wide resize-none"
              placeholder="Message"
            ></textarea>
            <label for="message" 
              class="absolute left-0 -top-3.5 text-xs text-[var(--brand-accent)] transition-all peer-placeholder-shown:text-base peer-placeholder-shown:text-white/40 peer-placeholder-shown:top-3 peer-focus:-top-3.5 peer-focus:text-[var(--brand-accent)] peer-focus:text-xs uppercase tracking-widest">
              Project Details
            </label>
          </div>

          <div class="pt-4">
            <button type="submit" class="group w-full py-4 bg-[var(--brand-accent)] text-[var(--brand-primary)] font-bold uppercase tracking-[0.2em] text-sm rounded-lg shadow-[0_10px_30px_rgba(198,172,143,0.2)] hover:shadow-[0_15px_40px_rgba(198,172,143,0.4)] hover:-translate-y-1 transition-all duration-300 flex items-center justify-center gap-2">
              <span>Send Message</span>
              <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
            </button>
          </div>
        </form>

        <div id="success-message" class="absolute inset-0 flex flex-col items-center justify-center text-center opacity-0 invisible transition-all duration-700 transform scale-95 pointer-events-none">
          <div class="w-24 h-24 rounded-full bg-[var(--brand-accent)]/10 flex items-center justify-center mb-6">
             <svg class="w-12 h-12 text-[var(--brand-accent)] check-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path class="check-path" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
             </svg>
          </div>
          <h3 class="text-3xl font-serif font-medium text-white mb-2">Message Sent</h3>
          <p class="text-white/60 max-w-xs leading-relaxed">
            Thank you. We have received your inquiry and will be in touch shortly.
          </p>
          <button id="reset-btn" class="mt-8 text-[var(--brand-accent)] text-xs uppercase tracking-widest border-b border-[var(--brand-accent)] pb-1 hover:text-white hover:border-white transition-colors cursor-pointer pointer-events-auto">
            Send another message
          </button>
        </div>

      </div>
    </div>
  </div>
</section>

<style>
  .check-path {
    stroke-dasharray: 100;
    stroke-dashoffset: 100;
    transition: stroke-dashoffset 1s ease-in-out 0.2s;
  }
  .animate-check .check-path {
    stroke-dashoffset: 0;
  }
</style>

<script>
  const form = document.getElementById('contact-form');
  const successMsg = document.getElementById('success-message');
  const resetBtn = document.getElementById('reset-btn');
  const checkIcon = document.querySelector('.check-icon');

  // TU URL REAL
  const FORMSPREE_ENDPOINT = "https://formspree.io/f/xdkjyjek"; 

  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const btn = form.querySelector('button');
      const originalText = btn.innerHTML;
      
      // 1. Feedback visual "Sending..."
      btn.innerHTML = `<span class="animate-pulse">Sending...</span>`;
      btn.disabled = true;

      // 2. Datos
      const formData = new FormData(form);
      
      try {
        // 3. Envío real
        const response = await fetch(FORMSPREE_ENDPOINT, {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });

        if (response.ok) {
          // ÉXITO: Animación
          form.classList.add('opacity-0', 'invisible', 'scale-95');
          successMsg.classList.remove('opacity-0', 'invisible', 'scale-95', 'pointer-events-none');
          successMsg.classList.add('opacity-100', 'visible', 'scale-100');
          checkIcon.classList.add('animate-check');
          form.reset();
        } else {
          alert("Oops! There was a problem submitting your form.");
          btn.innerHTML = originalText;
        }

      } catch (error) {
        console.error('Error:', error);
        alert("Network error. Please try again later.");
        btn.innerHTML = originalText;
      } finally {
        btn.disabled = false;
        if (btn.innerHTML.includes("Sending")) btn.innerHTML = originalText; 
      }
    });
  }

  if (resetBtn) {
    resetBtn.addEventListener('click', () => {
      successMsg.classList.remove('opacity-100', 'visible', 'scale-100');
      successMsg.classList.add('opacity-0', 'invisible', 'scale-95', 'pointer-events-none');
      checkIcon.classList.remove('animate-check');
      
      const btn = form.querySelector('button');
      // Restaurar icono original del botón
      btn.innerHTML = `
        <span>Send Message</span>
        <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
      `;

      form.classList.remove('opacity-0', 'invisible', 'scale-95');
    });
  }
</script>